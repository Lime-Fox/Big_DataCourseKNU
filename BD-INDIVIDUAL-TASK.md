## **BD-INDIVIDUAL-TASK**

**В данном индивидуальном задании - аналитическая работа с дата сетом,
реализован один из методов, который будет использоваться при написании курсовой работы для конкретной прикладной задачи**

**ОБЩАЯ ИНФОРМАЦИЯ:**
 
**Для реализации задачи возьмем встроенный в R-STATISTICS                                                                                   
датасет ```airquality``` - New York Air Quality Measurements.**

**```Дата сет airquality содержит 153 измерения для 4 параметров```:                                                                            
```Ozone:```   сред. уровень озона                                                                                                                
```Solar.R:``` уровень солнечной радиации (в Ленгли)                                                                                             
```Wind:```    сред. скорость ветра       (миль/час)                                                                                                
```Temp:```    макс. дневная температура  (по Фаренгейту)**

```
Установим и подключим пакеты, необходимые для реализации проекта:
(Важно: некотрые из них входят в tidyverse - набор базовых пакетов для работы в R)

Для построения графиков:
Для реализации задачи разделения выборки - split():

install.packages("ggplot2")
library("ggplot2")

install.packages("caTools")
library(caTools)
```

**1.- Приведем дата-сет ```airquality``` к виду, пригодному для анализа:**

**1.1** - Выведем дата-фрейм airquality:
```
df<-data.frame(airquality)
d
```
```
      Ozone Solar.R Wind Temp Month Day
1      41     190  7.4   67     5   1
2      36     118  8.0   72     5   2
3      12     149 12.6   74     5   3
4      18     313 11.5   62     5   4
5      NA      NA 14.3   56     5   5
6      28      NA 14.9   66     5   6
7      23     299  8.6   65     5   7
...
151    14     191 14.3   75     9   28
152    18     131  8.0   76     9   29
153    20     223 11.5   68     9   30
```

**1.2** - Проверим отсутствие NA-данных:
```
all(colSums(is.na(df))==0)
```
```
[1] FALSE
```

**1.3** - Исключим NA-данные:
```
df1<-na.omit(df)
df1
```
```
1      41     190  7.4   67     5   1
2      36     118  8.0   72     5   2
3      12     149 12.6   74     5   3
4      18     313 11.5   62     5   4
7      23     299  8.6   65     5   7
...
151    14     191 14.3   75     9  28
152    18     131  8.0   76     9  29
153    20     223 11.5   68     9  30
```

**1.4** - Выведем первые 4 столбца дата-фрейма
(исключив столбцы 5 и 6 - Месяц и День)
```
df2<-df1[1:4]
df2
```
```
 Ozone Solar.R Wind Temp
1      41     190  7.4   67
2      36     118  8.0   72
3      12     149 12.6   74
4      18     313 11.5   62
7      23     299  8.6   65
...
151    14     191 14.3   75
152    18     131  8.0   76
153    20     223 11.5   68
```


**2. -  Приступим к анализу дата-сета.
      Temp (температура) - является зависимой переменной.
      Определим, от какого показателя она зависит больше всего и построим модель линейной регрессии.**

**2.1** - Получим базовые характеристики выборки по столбцам:
Cтатистические показатели - min, max, mean, median,
                            Квантили - Q1,Q3
                            NA - неизвестные значения
```
summary(df2)
```
```
 Ozone          Solar.R           Wind            Temp      
 Min.   :  1.0   Min.   :  7.0   Min.   : 2.30   Min.   :57.00  
 1st Qu.: 18.0   1st Qu.:113.5   1st Qu.: 7.40   1st Qu.:71.00  
 Median : 31.0   Median :207.0   Median : 9.70   Median :79.00  
 Mean   : 42.1   Mean   :184.8   Mean   : 9.94   Mean   :77.79  
 3rd Qu.: 62.0   3rd Qu.:255.5   3rd Qu.:11.50   3rd Qu.:84.50  
 Max.   :168.0   Max.   :334.0   Max.   :20.70   Max.   :97.00
```

**2.2** - Выведем значение переменной Temp в разных квантилях:
```
quantile(df2$Temp)
```
```
0%   25%  50%  75%  100% 
57.0 71.0 79.0 84.5 97.0 
```

**2.3** - Построим матрицу корреляции и определим наиболее зависимую переменную.
По полученным данным, 
переменная Temp имеет значимую корреляцию с переменнной Ozone.
```
cor(df2)
```
```
         Ozone      Solar.R    Wind       Temp
Ozone    1.0000000  0.3483417 -0.6124966  0.6985414
Solar.R  0.3483417  1.0000000 -0.1271835  0.2940876
Wind    -0.6124966 -0.1271835  1.0000000 -0.4971897
Temp     0.6985414  0.2940876 -0.4971897  1.0000000
```

**3. - Построим модель линейной регрессии**

**3.1** - Разобьем выборку на тренировочную (обучающую) и тестовую(проверочную)**
```
library(caTools)
set.seed(123)
split = sample.split(airquality$Temp, SplitRatio = 0.8)
Тренировочная выборка:
training_set = subset(airquality, split == TRUE)
Тестовая выборка:
test_set = subset(airquality, split == FALSE)
```
**3.2** - Тренируем модель:
```
regressor = lm(formula = Temp ~ Ozone, data = training_set)
```
**3.3** - Визуализация работы тренировочной выборки:
```
library(ggplot2)
ggplot() + 
geom_point(aes(x = training_set$Ozone, y = training_set$Temp), colour = 'red') + 
geom_line(aes(x = training_set$Ozone, y = predict(regressor, newdata = training_set)), colour = 'black') +
ggtitle('Temp vs Ozone (Training set)') +
xlab('Ozone') +
ylab('Temp')
```
![alt text](https://github.com/Lime-Fox/Big_DataCourseKNU/blob/master/BD-INDIVIDUAL-TASK%20(LR-1).png)

**3.4** - Визуализация работы тестовой выборки:
```
library(ggplot2)
ggplot() + 
geom_point(aes(x = test_set$Ozone, y = test_set$Temp),colour = 'red') +
geom_line(aes(x = test_set$Ozone, y = predict(regressor, newdata = test_set)), colour = 'blue') +
ggtitle('Temp vs Ozone (Test set)') +
xlab('Ozone') +
ylab('Temp')
```
![alt text](https://github.com/Lime-Fox/Big_DataCourseKNU/blob/master/BD-INDIVIDUAL-TASK%20(LR-2).png)

**3.4** - Оценим точность сделанных прогнозов. 
Рассчиатаем коэффициент детерминации R2.
```
rsq <- function (x, y) cor(x, y) ^ 2
r2 <- rsq(predict(regressor, newdata = test_set), test_set$Temp)
r2
```
```
[1] 0.5042276
```

**ВЫВОД:**
```
Полученную модель можно считать приемлимой. => 
Модель считается приемлимой при R2 = 50% и выше.
Полученный результат - R2 = 0.5 означает, что 50% результативного признака Temp объясняется 
влиянием факторного признака Ozone.
Если R2>0.8 (то есть максимально близок к 1) - модель считается точной.
Если R2=1, то между переменными существует полная зависимость.

Дата сет airquality состоит из 153 измерений, что достаточно для первичного анализа и выявления 
зависимости между переменными.
Для повышения точности построенной модели (=значения коэф-та R2) необходимо большее кол-во измерений,
которые покажут более высокий уровень зависимости между переменными.
Потому работа с большими сетами данных (Big Data) является залогом качества полученных моделей.
```
